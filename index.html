<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>E-commerce App</title>
    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
    <style>
        /* CSS Variables for Theming */
        :root {
            --primary-color: #ef4444;
            --secondary-color: #f9fafb;
            --text-dark: #1f2937;
            --text-light: #6b7280;
            --border-color: #e5e7eb;
            --white: #ffffff;
            --font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
        }

        /* Global Resets & Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: var(--font-family);
            background-color: var(--secondary-color);
            color: var(--text-dark);
            padding-bottom: 70px; /* Space for bottom nav */
        }
        .container {
            padding: 1rem;
        }

        /* Screen Management */
        .screen {
            display: none;
        }
        .screen.active {
            display: block;
        }

        /* Header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            background-color: var(--white);
            border-bottom: 1px solid var(--border-color);
        }
        .header h1 {
            font-size: 1.5rem;
            color: var(--primary-color);
        }

        /* Search Bar */
        .search-bar {
            display: flex;
            margin: 1rem;
        }
        .search-bar input {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            font-size: 1rem;
        }

        /* Banner Slider */
        .banner-slider {
            width: 100%;
            height: 200px;
            background-color: var(--border-color);
            margin-bottom: 1rem;
            border-radius: 8px;
            overflow: hidden;
        }
        .banner-slider img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        /* Categories */
        .categories {
            display: flex;
            gap: 0.75rem;
            overflow-x: auto;
            padding: 0.5rem 0;
            margin-bottom: 1rem;
        }
        .category-item {
            flex-shrink: 0;
            text-align: center;
        }
        .category-item div {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background-color: var(--white);
            border: 1px solid var(--border-color);
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }
        .category-item img { width: 100%; height: 100%; object-fit: cover; }
        .category-item p { margin-top: 0.5rem; font-size: 0.8rem; }
        
        /* Product Grid */
        .product-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
        }
        .product-card {
            background-color: var(--white);
            border-radius: 8px;
            overflow: hidden;
            border: 1px solid var(--border-color);
            position: relative;
        }
        .product-card img {
            width: 100%;
            height: 150px;
            object-fit: cover;
        }
        .product-card .info {
            padding: 0.75rem;
        }
        .product-card h3 {
            font-size: 1rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .product-card p {
            font-size: 0.9rem;
            color: var(--primary-color);
            font-weight: bold;
        }
        .product-card .fav-icon {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            cursor: pointer;
            font-size: 1.5rem;
            color: var(--text-light);
        }
        .product-card .fav-icon.active { color: var(--primary-color); }

        /* Bottom Navigation */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            display: flex;
            justify-content: space-around;
            background-color: var(--white);
            border-top: 1px solid var(--border-color);
            padding: 0.5rem 0;
            z-index: 1000;
        }
        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            color: var(--text-light);
            cursor: pointer;
            font-size: 0.75rem;
        }
        .nav-item.active {
            color: var(--primary-color);
        }
        .nav-item svg {
            width: 24px;
            height: 24px;
            margin-bottom: 4px;
        }

        /* Profile Screen */
        .profile-view .profile-header {
            display: flex;
            align-items: center;
            flex-direction: column;
            padding: 2rem 1rem;
            background: var(--primary-color);
            color: var(--white);
        }
        .profile-header img {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: var(--secondary-color);
            margin-bottom: 1rem;
            object-fit: cover;
        }
        .profile-menu ul {
            list-style: none;
        }
        .profile-menu li {
            padding: 1rem;
            border-bottom: 1px solid var(--border-color);
            cursor: pointer;
        }
        
        /* Login/Signup Form */
        .auth-form { padding: 2rem 1rem; }
        .auth-form h2 { text-align: center; margin-bottom: 1.5rem; }
        .form-group { margin-bottom: 1rem; }
        .form-group input { width: 100%; padding: 0.75rem; border: 1px solid var(--border-color); border-radius: 8px; }
        .btn {
            width: 100%;
            padding: 0.8rem;
            background-color: var(--primary-color);
            color: var(--white);
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
        }
        .auth-toggle { text-align: center; margin-top: 1rem; color: var(--primary-color); cursor: pointer; }

        /* Cart Screen */
        .cart-item {
            display: flex;
            padding: 1rem;
            border-bottom: 1px solid var(--border-color);
            align-items: center;
        }
        .cart-item img { width: 80px; height: 80px; object-fit: cover; border-radius: 8px; margin-right: 1rem; }
        .cart-item .info { flex-grow: 1; }
        .cart-item .remove-btn { color: var(--primary-color); cursor: pointer; }
        .cart-summary {
            padding: 1rem;
            border-top: 1px solid var(--border-color);
            margin-top: 1rem;
        }

        /* Track Order Screen */
        .timeline {
            list-style-type: none;
            position: relative;
            padding-left: 1.5rem;
        }
        .timeline:before {
            content: ' ';
            background: var(--border-color);
            position: absolute;
            left: 10px;
            top: 0;
            bottom: 0;
            width: 2px;
        }
        .timeline-item {
            position: relative;
            margin-bottom: 2rem;
        }
        .timeline-item:before {
            content: ' ';
            background: var(--white);
            border: 3px solid var(--border-color);
            border-radius: 50%;
            position: absolute;
            left: -20px;
            top: 0;
            width: 14px;
            height: 14px;
            z-index: 1;
        }
        .timeline-item.completed:before {
            border-color: var(--primary-color);
            background: var(--primary-color);
        }
        .timeline-item h4 { font-size: 1rem; }
        .timeline-item p { font-size: 0.9rem; color: var(--text-light); }
        .track-package-btn { margin-top: 1rem; display: none; }

    </style>
</head>
<body>

    <!-- App Screens Container -->
    <div id="app">

        <!-- Home Screen -->
        <div id="home-screen" class="screen active">
            <header class="header"><h1>MyStore</h1></header>
            <div class="search-bar">
                <input type="text" id="search-input" placeholder="Search for products...">
            </div>
            <div class="banner-slider" id="banner-slider"></div>
            <div class="container">
                <h2>Categories</h2>
                <div class="categories" id="categories-container"></div>
                <h2>Products</h2>
                <div class="product-grid" id="product-grid"></div>
            </div>
        </div>

        <!-- Search Results Screen -->
        <div id="search-screen" class="screen">
            <header class="header"><h1>Search Results</h1></header>
            <div class="container" id="search-results-container"></div>
        </div>

        <!-- Product Details Screen -->
        <div id="details-screen" class="screen">
             <!-- Dynamic Content -->
        </div>

        <!-- Cart Screen -->
        <div id="cart-screen" class="screen">
            <header class="header"><h1>My Cart</h1></header>
            <div id="cart-items-container"></div>
            <div class="cart-summary" id="cart-summary"></div>
        </div>

        <!-- Favorites Screen -->
        <div id="wishlist-screen" class="screen">
            <header class="header"><h1>My Wishlist</h1></header>
            <div class="product-grid container" id="wishlist-items-container"></div>
        </div>
        
        <!-- Profile Screen -->
        <div id="profile-screen" class="screen">
            <!-- Login/Signup View -->
            <div id="auth-view">
                <div id="login-form" class="auth-form">
                    <h2>Login</h2>
                    <div class="form-group"><input type="email" id="login-email" placeholder="Email"></div>
                    <div class="form-group"><input type="password" id="login-password" placeholder="Password"></div>
                    <button id="login-btn" class="btn">Login</button>
                    <p class="auth-toggle" onclick="toggleAuthForms()">Don't have an account? Sign Up</p>
                </div>
                <div id="signup-form" class="auth-form" style="display: none;">
                    <h2>Sign Up</h2>
                    <div class="form-group"><input type="text" id="signup-name" placeholder="Full Name"></div>
                    <div class="form-group"><input type="email" id="signup-email" placeholder="Email"></div>
                    <div class="form-group"><input type="password" id="signup-password" placeholder="Password"></div>
                    <button id="signup-btn" class="btn">Sign Up</button>
                    <p class="auth-toggle" onclick="toggleAuthForms()">Already have an account? Login</p>
                </div>
            </div>
            
            <!-- Profile View (Logged In) -->
            <div id="profile-view" class="profile-view" style="display: none;">
                <div class="profile-header">
                    <img id="profile-pic" src="https://via.placeholder.com/80" alt="Profile Picture">
                    <h2 id="profile-name">Guest</h2>
                </div>
                <div class="profile-menu">
                    <ul>
                        <li id="menu-my-orders">My Orders</li>
                        <li id="menu-manage-address">Manage Address</li>
                        <li id="menu-contact-us">Contact Us</li>
                        <li id="logout-btn">Logout</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- My Orders Screen -->
        <div id="orders-screen" class="screen">
            <header class="header"><h1>My Orders</h1></header>
            <div class="container" id="orders-list-container"></div>
        </div>

        <!-- Track Order Screen -->
        <div id="track-order-screen" class="screen">
            <header class="header"><h1>Track Order</h1></header>
            <div class="container">
                <p>Order ID: <span id="track-order-id"></span></p>
                <ul class="timeline" id="order-timeline">
                    <li class="timeline-item" data-status="Order Placed"><h4>Order Placed</h4><p>We have received your order.</p></li>
                    <li class="timeline-item" data-status="In Progress"><h4>In Progress</h4><p>Your order is being prepared.</p></li>
                    <li class="timeline-item" data-status="Shipped"><h4>Shipped</h4><p>Your order is on its way.</p></li>
                    <li class="timeline-item" data-status="Delivered"><h4>Delivered</h4><p>Your order has been delivered.</p></li>
                </ul>
                <button id="track-package-btn" class="btn track-package-btn">Track Package</button>
            </div>
        </div>

        <!-- Delivery Address Screen -->
        <div id="address-screen" class="screen">
            <header class="header"><h1>Delivery Address</h1></header>
            <div class="container">
                <div class="form-group"><input type="text" id="address-name" placeholder="Full Name"></div>
                <div class="form-group"><input type="text" id="address-mobile" placeholder="Mobile Number"></div>
                <div class="form-group"><input type="text" id="address-pincode" placeholder="Pincode"></div>
                <div class="form-group"><input type="text" id="address-city" placeholder="City" readonly></div>
                <div class="form-group"><input type="text" id="address-state" placeholder="State" readonly></div>
                <div class="form-group"><textarea id="address-full" placeholder="Full Address (House No, Street)"></textarea></div>
                <h3>Payment Method</h3>
                <div>
                    <input type="radio" id="cod" name="payment" value="COD" checked>
                    <label for="cod">Cash on Delivery</label>
                </div>
                <div>
                    <input type="radio" id="online" name="payment" value="Online">
                    <label for="online">Online Payment</label>
                </div>
                <button id="place-order-btn" class="btn">Place Order</button>
            </div>
        </div>

        <!-- Order Confirmation Screen -->
        <div id="confirmation-screen" class="screen">
            <div class="container" style="text-align: center; padding-top: 5rem;">
                <h2>✅</h2>
                <h1>Order Placed Successfully!</h1>
                <p>Thank you for your purchase.</p>
                <button id="continue-shopping-btn" class="btn">Continue Shopping</button>
            </div>
        </div>

    </div>

    <!-- Bottom Navigation Bar -->
    <nav class="bottom-nav">
        <div class="nav-item active" data-screen="home-screen">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/></svg>
            <span>Home</span>
        </div>
        <div class="nav-item" data-screen="wishlist-screen">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 016.364 0L12 7.5l1.318-1.182a4.5 4.5 0 116.364 6.364L12 21l-7.682-7.682a4.5 4.5 0 010-6.364z" /></svg>
            <span>Wishlist</span>
        </div>
        <div class="nav-item" data-screen="cart-screen">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"/></svg>
            <span>Cart</span>
        </div>
        <div class="nav-item" data-screen="profile-screen">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/></svg>
            <span>Profile</span>
        </div>
    </nav>

    <script type="module">
        // Import Firebase modules
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-app.js";
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-auth.js";
        import { getDatabase, ref, set, get, onValue, remove, push } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-database.js";
        import { getStorage, ref as storageRef, uploadBytes, getDownloadURL } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-storage.js";

        // 🚀🚀🚀 Yahan par apna Firebase Configuration File Add karo 🚀🚀🚀
       const firebaseConfig = {
  apiKey: "AIzaSyC647wYAJJk1zFWYo3oMLomK7wEFpEWkHE",
  authDomain: "trion-fashion.firebaseapp.com",
  databaseURL: "https://trion-fashion-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "trion-fashion",
  storageBucket: "trion-fashion.firebasestorage.app",
  messagingSenderId: "123766462009",
  appId: "1:123766462009:web:25344194e3fe33abe19fe8",
  measurementId: "G-ES0DV7GSVV"
};

        // 🚀🚀🚀 Yahan par apna Razorpay payment gateway key add karo 🚀🚀🚀
        const RAZORPAY_KEY_ID = "rzp_test_...";

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getDatabase(app);
        const storage = getStorage(app);

        let currentUser = null;

        // --- App Initialization & Navigation ---
        document.addEventListener('DOMContentLoaded', () => {
            // Your app initialization code here
        });

        // --- Authentication ---
        onAuthStateChanged(auth, (user) => {
            if (user) {
                currentUser = user;
                document.getElementById('profile-view').style.display = 'block';
                document.getElementById('auth-view').style.display = 'none';
                loadUserProfile(user);
                loadCart();
                loadWishlist();
            } else {
                currentUser = null;
                document.getElementById('profile-view').style.display = 'none';
                document.getElementById('auth-view').style.display = 'block';
            }
        });

        // --- UI Navigation ---
        const screens = document.querySelectorAll('.screen');
        const navItems = document.querySelectorAll('.nav-item');
        
        function navigateTo(screenId) {
            screens.forEach(s => s.classList.remove('active'));
            document.getElementById(screenId).classList.add('active');
            navItems.forEach(n => {
                n.classList.toggle('active', n.dataset.screen === screenId);
            });
        }

        navItems.forEach(item => {
            item.addEventListener('click', () => {
                const screenId = item.dataset.screen;
                if (screenId === 'cart-screen' || screenId === 'wishlist-screen' || screenId === 'profile-screen') {
                    if (!currentUser) {
                        navigateTo('profile-screen');
                        return;
                    }
                }
                navigateTo(screenId);
            });
        });
        
        // --- Dummy Data & Functions (Replace with Firebase calls) ---
        function loadUserProfile(user) {
            const userRef = ref(db, `users/${user.uid}`);
            onValue(userRef, (snapshot) => {
                const data = snapshot.val();
                if (data) {
                    document.getElementById('profile-name').textContent = data.name || 'User';
                    if (data.profilePic) {
                        document.getElementById('profile-pic').src = data.profilePic;
                    }
                }
            });
        }
        
        // More JS functions for cart, wishlist, orders would go here
        // ... (For brevity, only key functionalities are outlined)
        
        // Example: load products
        const productsRef = ref(db, 'products');
        onValue(productsRef, (snapshot) => {
            const products = snapshot.val();
            const grid = document.getElementById('product-grid');
            grid.innerHTML = '';
            for (const key in products) {
                const product = products[key];
                const card = document.createElement('div');
                card.className = 'product-card';
                card.innerHTML = `
                    <img src="${product.imageUrl}" alt="${product.name}">
                    <div class="info">
                        <h3>${product.name}</h3>
                        <p>₹${product.price}</p>
                    </div>
                    <span class="fav-icon">&hearts;</span>
                `;
                grid.appendChild(card);
            }
        });
        
        // --- Order Placement ---
        document.getElementById('place-order-btn').addEventListener('click', async () => {
            if (!currentUser) { alert("Please login first!"); return; }

            const orderDetails = {
                userId: currentUser.uid,
                items: [/* cart items here */],
                address: { /* address details */ },
                total: 1000, // calculate total
                status: 'Order Placed',
                placedAt: new Date().toISOString(),
                trackingLink: ''
            };

            const newOrderRef = push(ref(db, `orders/${currentUser.uid}`));
            await set(newOrderRef, orderDetails);

            // Notify Admin (simple version)
            const notificationRef = push(ref(db, 'notifications'));
            await set(notificationRef, {
                orderId: newOrderRef.key,
                userId: currentUser.uid,
                total: orderDetails.total,
                timestamp: Date.now(),
                isNew: true
            });
            
            // Clear cart
            await remove(ref(db, `carts/${currentUser.uid}`));
            
            navigateTo('confirmation-screen');
        });

        // --- Pincode API ---
        document.getElementById('address-pincode').addEventListener('blur', async (e) => {
            const pincode = e.target.value;
            if (pincode.length === 6) {
                const response = await fetch(`https://api.postalpincode.in/pincode/${pincode}`);
                const data = await response.json();
                if (data[0].Status === 'Success') {
                    const postOffice = data[0].PostOffice[0];
                    document.getElementById('address-city').value = postOffice.District;
                    document.getElementById('address-state').value = postOffice.State;
                }
            }
        });

    </script>
</body>
</html>